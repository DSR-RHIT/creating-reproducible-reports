---
title: "Load-cell calibration report"
author: "Richard Layton"
date: '2016-08-24'
output: word_document
csl: ieee.csl
bibliography: calibration.bib
---

```{r 05-01, include = FALSE}
library(knitr)
opts_knit$set(root.dir = '../')
opts_chunk$set(echo = FALSE)
```

```{r 05-02}
library(plyr)
suppressPackageStartupMessages(library(dplyr))
library(readr)
```

# Introduction

The goal of this analysis is to determine the calibration equation and sensor accuracy for an Omega LCL-005 (0--5 lb) load cell. 

The test setup is illustrated in Figure 1. Precision weights (0.1% accuracy) are used to apply the reference force (lb) to the load cell and the resulting voltage readings (mV) from the sensor are recorded. The test procedure follows the ANSI/ISA standard [@ansi-isa-1995].

```{r 05-03, fig.cap = 'Figure 1. Load cell calibration test setup'}
knitr::include_graphics("../resources/load-cell-setup-786x989px.png")
```

# Data

```{r 05-04}
# itemized results that are cited in the report 
results_df <- read_csv('results/04_calibr_outcomes.csv')

# specific numbers are easier to extract from a list
results_list <- dlply(results_df, 'item')

# extract values and units
slope       <- results_list$slope$num 
intercept   <- results_list$intercept$num  
accuracy    <- results_list$accuracy$num 
resid_bound <- results_list$resid_bound$num  
input_min   <- results_list$input_min$num  
input_max   <- results_list$input_max$num 
output_min  <- results_list$output_min$num 
output_max  <- results_list$output_max$num  

# extract units
input_unit  <- results_list$input_min$unit 
output_unit <- results_list$output_min$unit 

# compute range and span
output_span <- output_max - output_min
input_range_fraction <- round(input_max / 5 * 100, 1)
```

The calibration data are shown in Table 1. The maximum force (`r input_max` lb) is `r input_range_fraction`% of the 5 lb sensor limit, per the ANSI/ISA standard.

```{r 05-05}
# read the data set as received
data_received <- read_csv('data/007_wide-data.csv')
data_received <- data_received %>%
	select("Input (lb)" = input_lb, "Cycle 1 (mV)" = cycle_1, "Cycle 2 (mV)" = 
cycle_2, "Cycle 3 (mV)" = cycle_3)
	
kable(data_received, caption = "Table 1. Calibration data")
```

# Results

The calibration data and calibration curve are shown in Figure 2. The maximum $\pm$ deviations of the data from the best-fit curve (residuals) are the values used to estimate sensor accuracy. 

```{r 05-06, fig.cap = 'Figure 2. Load cell calibration curve'}
knitr::include_graphics("../results/03_calibr_graph.png")
```

The calibration equation is
$$
y = `r sprintf("%.3f", slope)`  x + `r sprintf("%.3f", intercept)`
$$
with *x* in `r input_unit` and *y* in `r output_unit`.

The largest residual is `r sprintf("%.1f", resid_bound)` mV and the output span is `r sprintf("%.1f", output_span)` mV, yielding a sensor accuracy as a percent of reading of 
$$
\pm `r sprintf("%.1f", accuracy)`\%. 
$$
The accuracy of the precision weights, 0.1%, is less than one tenth the load cell accuracy, thereby meeting the requirements of the ANSI/ISA standard.  

# References

